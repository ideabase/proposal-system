{# /templates/clients/_category.twig #}

{% extends '_layout' %}

{% block content %}

  {# page title #}
  <h1>{{ category.title }}</h1>

  {# contacts #}
  <h2>
    {% if category.contacts.all()|length == 1 %}Contact{% else %}Contacts{% endif %}
  </h2>
  {# TODO: check if contacts exist #}
  {# begin contacts loop #}
  {% for block in category.contacts.all() %}
    {% set count = 1 %}
    {% if count > 1 %}
      <h4>Contact {{ count }}</h4>
    {% endif %}
    <div>
      {# IMPORTANT: HTML WILL CHANGE IF <p> IS FORMATTED - prints prefix if exists, first name, last name, suffix if exists, title if exists #}
      <p>{% if block.prefix is not empty %}{{ block.prefix|title }}&nbsp;{% endif %}{{ block.firstName|title }}&nbsp;{{ block.lastName|title }}{% if block.suffix is not empty %}{% if block.suffix == "I"|upper or block.suffix == "II"|upper or block.suffix == "III"|upper or block.suffix == "IV"|upper or block.suffix == "V"|upper %}&nbsp;{{ block.suffix|upper }}&nbsp;{% else %}&comma;&nbsp;{{ block.suffix }}&nbsp;{% endif %}{% endif %}{% if block.contactTitle is not empty %}&sol;&nbsp;{{ block.contactTitle|title }}{% endif %}</p>

      {% if block.phoneNumber is not empty %}
        <p>{{ block.phoneNumber }}</p>
      {% endif %}

      {% if block.email is not empty %}
        <p>{{ block.email }}</p>
      {% endif %}

      {% if block.otherInformation is not empty %}
        <p>{{ block.otherInformation }}</p>
      {% endif %}
    </div>
  {% endfor %}
  {# end contacts loop #}

  {# addresses #}
  <h2>
    {% if category.addresses.all()|length == 1 %}Address{% else %}Addresses{% endif %}
  </h2>
  {# TODO: check if addresses exist #}
  {# begin addresses loop #}
  {% for block in category.addresses.all() %}
    {% set count = 1 %}
    {% if count > 1 %}
      <h4>Address {{ count }}</h4>
    {% endif %}

    <div>
      <p>{{ block.address1|title }}</p>

      {% if block.address2 is not empty %}
        <p>{{ block.address2|title }}</p>
      {% endif %}

      <p>{{ block.city|title }}, {{ block.state|upper }} {{ block.zipCode }}</p>

      {% if block.description is not empty %}
        <p>{{ block.description }}</p>
      {% endif %}
    </div>
  {% endfor %}
  {# end addresses loop #}

  {# proposals #}
  <h2>
    {% if craft.categories.group('clients').title(category.title).all()|length == 1 %}Proposal{% else %}Proposals{% endif %}
  </h2>
  {# TODO: check if proposals exist #}
  {# begin proposals loop #}
  {% for entry in craft.entries.section('proposals').relatedTo(category).all() %}
      <a href="{{ entry.url }}" target="_blank">{{ entry.title }}</a>
  {% endfor %}
  {# end proposals loop #}

{% endblock %}
{# end content block #}
